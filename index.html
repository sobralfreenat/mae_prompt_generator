<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ENCODER M.A.E.</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .campo-principal {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        textarea, input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
            font-family: inherit;
        }
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        .button-group {
            margin: 20px 0;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        button {
            padding: 10px 15px;
            background-color: #346067;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2a4c52;
        }
        pre {
            background-color: #f8f8f8;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            border: 1px solid #ddd;
        }
        .referencias-section {
            margin: 20px 0;
            border: 1px dashed #ccc;
            border-radius: 4px;
        }
        .collapse-trigger {
            width: 100%;
            padding: 10px;
            text-align: left;
            background: #f8f8f8;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .collapse-trigger:hover {
            background: blue;
            color: white;
        }
        .collapse-trigger small {
            color: blue;
            margin-left: auto;
        }
        .collapse-trigger:hover small {
            color: white;
        }
        .collapse-content {
            padding: 15px;
            border-top: 1px dashed #ccc;
        }
        .referencias-lista {
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
        }
        .referencia-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-bottom: 1px solid #eee;
        }
        .referencia-item button {
            padding: 2px 6px;
            background: #ff4444;
        }
        #outroLinkIA {
            margin-top: 10px;
        }
        .ia-selector {
            margin-bottom: 20px;
        }
        #statusVerificacao {
            padding: 8px;
            margin: 10px 0;
            border-radius: 4px;
            background-color: #f8f8f8;
            border: 1px solid #ddd;
        }
        .url-search-container {
            display: flex;
            gap: 10px;
            flex: 1;
        }
        .url-search-container input {
            flex: 1;
        }
        .search-button {
            background-color: #4285f4;
            white-space: nowrap;
        }
        .search-button:hover {
            background-color: #357abd;
        }
        .add-button {
            white-space: nowrap;
        }
        .referencias-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        #promptEditorContainer {
            margin-top: 20px;
            margin-bottom: 20px;
        }
        #promptEditor {
            width: 100%;
            min-height: 200px;
            margin-top: 10px;
            margin-bottom: 10px;
            display: none;
        }
        #editButton, #togglePromptEditor {
            margin-right: 10px;
        }
        .modo-entrada {
            display: none;
        }
    </style>
</head>
<body>
<img src="https://d1yei2z3i6k35z.cloudfront.net/3119789/666e1df34d7ed_BannerFNWAssessoriaDigitalprovisorio.png" alt="Banner" style="width: 22%; height: auto; display: block; margin-left: 600; margin-right: 420;" loading="lazy">
<div class="container">
    <h1>ENCODER M.A.E.</h1>
    <br>


    <form id="maeForm">

<button class="button" onclick="abrirOuFocarJanela('https://sobralfreenat.github.io/desafios_e_temas_prompt_text/', 'Instancia 01 P.A.I.', 280, 900, 0, 100)">Desafio /T√≥pico</button> <br>

        <div class="modo-selector">
            <br><label>Escolha o modo de entrada:</label>
            <select id="modoEntrada" onchange="alternarModoEntrada()">
                <option value="youtube">Refer√™ncia YouTube com Transcri√ß√£o</option>
                <option value="manual">Entrada Manual (Princ√≠pios, Desenvolvido por, Aplica√ß√£o)</option>
                <option value="cliente">Texto ou Documento do Cliente</option>
            </select>
        </div>

        <div id="modoYoutube" class="modo-entrada">
            <div class="campo-principal">
                <label for="urlVideo">URL do V√≠deo do YouTube:</label>
                <input type="url" id="urlVideo" placeholder="https://www.youtube.com/watch?v=...">
            </div>
            <div class="campo-principal">
                <label for="transcricaoYoutube">Transcri√ß√£o do YouTube:</label>
                <textarea id="transcricaoYoutube" placeholder="Cole aqui a transcri√ß√£o do v√≠deo do YouTube..."></textarea>
                <button type="button" onclick="processarTranscricaoYoutube()">Processar Transcri√ß√£o</button>
            </div>
        </div>

        <div id="modoManual" class="modo-entrada" style="display: none;">
            <div class="campo-principal">
                <label for="principios">Princ√≠pios:</label>
                <textarea id="principios" placeholder="Descreva detalhadamente os princ√≠pios..."></textarea>
            </div>
            <div class="campo-principal">
                <label for="desenvolvidoPor">Desenvolvido por:</label>
                <textarea id="desenvolvidoPor" placeholder="Informa√ß√µes sobre autor/desenvolvedor..."></textarea>
            </div>
            <div class="campo-principal">
                <label for="aplicacao">Aplica√ß√£o em:</label>
                <textarea id="aplicacao" placeholder="Contexto detalhado de aplica√ß√£o..."></textarea>
            </div>
        </div>

        <div id="modoCliente" class="modo-entrada" style="display: none;">
            <div class="campo-principal">
                <label for="textoCliente">Texto ou Documento do Cliente:</label>
                <textarea id="textoCliente" placeholder="Cole aqui o texto do cliente ou a estrutura M.A.E. (Categoria, T√≠tulo, Descri√ß√£o, URL)..."></textarea>
                <button type="button" onclick="processarTextoCliente()">Processar Texto do Cliente</button>
            </div>
        </div>

        <div class="campo-principal">
            <label for="titulo_resumido">T√≠tulo Principal (m√°x. 5 palavras):</label>
            <input type="text" id="titulo_resumido" maxlength="50" placeholder="Resumo conciso do tema principal" required>
        </div>

        <div class="referencias-section">
            <button type="button" class="collapse-trigger" onclick="toggleReferencias()">
                <span class="icon">‚ñ∂</span> Sites de Refer√™ncia (opcional)
                <small>Expandir para adicionar sites base para gera√ß√£o de URLs</small>
            </button>
            
            <div id="referenciasCollapse" class="collapse-content" style="display: none;">
                <div class="referencias-container">
                    <div class="referencias-input-group">
                        <div class="url-search-container">
                            <input type="url" id="referenciaUrl" placeholder="https://site-referencia.com">
                            <button type="button" onclick="abrirPesquisaGoogle()" class="search-button">
                                üîç Pesquisar
                            </button>
                        </div>
                        <button type="button" onclick="referencias.adicionar()" class="add-button">Adicionar</button>
                    </div>
                    <div id="listaReferencias" class="referencias-lista"></div>
                    <small>As URLs geradas ser√£o baseadas nestes sites de refer√™ncia</small>
                </div>
            </div>
        </div>

        <div class="ia-selector">
            <label for="iaEscolhida">Escolha sua IA:</label>
            <select id="iaEscolhida" onchange="verificarSelecaoIA()" required>
                <option value="">Selecione uma IA</option>
                <option value="https://chat.openai.com/">ChatGPT (OpenAI)</option>
                <option value="https://gemini.google.com/">Gemini (Google)</option>
                <option value="https://claude.ai/">Claude (Anthropic)</option>
                <option value="https://copilot.microsoft.com/">Copilot (Microsoft)</option>
                <option value="outro">Outra IA...</option>
            </select>
            
            <div id="outroLinkIA" style="display: none;">
                <label for="linkPersonalizado">Cole o link da IA:</label>
                <input type="url" id="linkPersonalizado" placeholder="https://sua-ia-preferida.com">
            </div>
        </div>

        <div class="button-group">
            <button type="button" onclick="gerarJSONePrompt().catch(error => { console.error(error); alert('Erro ao gerar JSON e prompt: ' + error.message); })">1. Gerar JSON e Prompt</button>
            <button type="button" onclick="copiarPrompt()">2. Copiar Prompt</button>
            <button type="button" onclick="abrirIASelecionada()">3. Abrir IA Selecionada</button>


        </div>
    </form>

    <h6>JSON Gerado:</h6>
    <pre id="jsonOutput"></pre>
    
    <h6>Prompt Gerado:</h6>
    <pre id="promptOutput"></pre>

    <h6>Editar Prompt:</h6>
    <div id="promptEditorContainer">
        <button id="togglePromptEditor">Expandir Editor</button>
        <textarea id="promptEditor" rows="10"></textarea>
        <button id="editButton">Atualizar Prompt</button>
    </div>

    <h6>Colar Texto da IA:</h6>
    <textarea id="gptText" rows="10"></textarea>
    <button type="button" onclick="processarTextoGPT()">4. Processar Texto</button>

    <button id="saveStateButton">Salvar Estado</button>
    <button id="loadStateButton">Carregar Estado</button>
</div>

<script>
// Configura√ß√£o do sistema
const MAE_CONFIG = {
    versao: 'free',
    features: {
        referencias: {
            limiteDominio: false,
            limiteQuantidade: false,
            maxReferencias: Infinity,
            permiteDeletar: true
        }
    }
};

// Sistema de refer√™ncias
const referencias = {
    lista: [],
    
    adicionar: function() {
        const input = document.getElementById('referenciaUrl');
        const url = input.value.trim();
        
        if (url && this.validarUrl(url)) {
            if (this.podeAdicionarReferencia(url)) {
                this.lista.push({
                    url: url,
                    timestamp: new Date().toISOString()
                });
                this.atualizarLista();
                input.value = '';
                this.salvarReferencias();
            }
        }
    },

    podeAdicionarReferencia: function(novaUrl) {
        const config = MAE_CONFIG.features.referencias;
        
        if (config.limiteQuantidade && this.lista.length >= config.maxReferencias) {
            alert('Limite de refer√™ncias atingido. Fa√ßa upgrade para adicionar mais!');
            return false;
        }
        return true;
    },

    remover: function(index) {
        if (MAE_CONFIG.features.referencias.permiteDeletar) {
            this.lista.splice(index, 1);
            this.atualizarLista();
            this.salvarReferencias();
        } else {
            alert('Remo√ß√£o de refer√™ncias dispon√≠vel apenas na vers√£o PRO!');
        }
    },

    atualizarLista: function() {
        const container = document.getElementById('listaReferencias');
        container.innerHTML = '';
        
        this.lista.forEach((ref, index) => {
            const div = document.createElement('div');
            div.className = 'referencia-item';
            div.innerHTML = `
                <a href="${ref.url}" target="_blank">${ref.url}</a>
                <button onclick="referencias.remover(${index})">√ó</button>
            `;
            container.appendChild(div);
        });
    },

    validarUrl: function(url) {
        try {
            new URL(url);
            return true;
        } catch {
            alert('Por favor, insira uma URL v√°lida');
            return false;
        }
    },

    salvarReferencias: function() {
        localStorage.setItem('mae_referencias', JSON.stringify(this.lista));
    },

    carregarReferencias: function() {
        const salvas = localStorage.getItem('mae_referencias');
        if (salvas) {
            this.lista = JSON.parse(salvas);
            this.atualizarLista();
        }
    },

    gerarUrlValida: function(categoria, contexto) {
        if (this.lista.length === 0) {
            return `https://exemplo.com/${categoria.toLowerCase()}/${contexto.toLowerCase()}`;
        }
        
        const indiceAleatorio = Math.floor(Math.random() * this.lista.length);
        const urlBase = this.lista[indiceAleatorio].url.replace(/\/+$/, '');
                return `${urlBase}/${categoria.toLowerCase()}/${contexto.toLowerCase()}`;
    }
};

function escapeUnicode(str) {
    return str.replace(/[^\0-~]/g, function(ch) {
        return "\\u" + ("000" + ch.charCodeAt().toString(16)).slice(-4);
    });
}

function verificarSelecaoIA() {
    const select = document.getElementById('iaEscolhida');
    const outroLink = document.getElementById('outroLinkIA');
    
    if (select.value === 'outro') {
        outroLink.style.display = 'block';
    } else {
        outroLink.style.display = 'none';
    }
}

function toggleReferencias() {
    const content = document.getElementById('referenciasCollapse');
    const trigger = document.querySelector('.collapse-trigger .icon');
    
    if (content.style.display === 'none') {
        content.style.display = 'block';
        trigger.textContent = '‚ñº';
    } else {
        content.style.display = 'none';
        trigger.textContent = '‚ñ∂';
    }
}

function abrirPesquisaGoogle() {
    const principios = document.getElementById('principios').value;
    const desenvolvidoPor = document.getElementById('desenvolvidoPor').value;
    const aplicacao = document.getElementById('aplicacao').value;
    
    const searchQuery = encodeURIComponent(`${principios} ${desenvolvidoPor} ${aplicacao}`);
    const googleUrl = `https://www.google.com/search?q=${searchQuery}`;
    
    const width = 800;
    const height = 600;
    const left = (window.innerWidth - width) / 2;
    const top = (window.innerHeight - height) / 2;
    
    window.open(
        googleUrl,
        'GoogleSearch',
        `width=${width},height=${height},left=${left},top=${top},menubar=no,toolbar=no,location=no,status=no`
    );
}

function alternarModoEntrada() {
    const modo = document.getElementById('modoEntrada').value;
    document.getElementById('modoYoutube').style.display = modo === 'youtube' ? 'block' : 'none';
    document.getElementById('modoManual').style.display = modo === 'manual' ? 'block' : 'none';
    document.getElementById('modoCliente').style.display = modo === 'cliente' ? 'block' : 'none';
}

async function gerarJSONePrompt() {
    const modo = document.getElementById('modoEntrada').value;
    let principios, desenvolvidoPor, aplicacao, urlVideo;

    switch (modo) {
        case 'youtube':
            urlVideo = escapeUnicode(document.getElementById('urlVideo').value);
            principios = escapeUnicode(document.getElementById('principios').value);
            desenvolvidoPor = escapeUnicode(document.getElementById('desenvolvidoPor').value);
            aplicacao = escapeUnicode(document.getElementById('aplicacao').value);
            break;
        case 'manual':
            principios = escapeUnicode(document.getElementById('principios').value);
            desenvolvidoPor = escapeUnicode(document.getElementById('desenvolvidoPor').value);
            aplicacao = escapeUnicode(document.getElementById('aplicacao').value);
            break;
        case 'cliente':
            // Processar texto do cliente
            const textoCliente = document.getElementById('textoCliente').value;
            // Aqui voc√™ precisaria implementar a l√≥gica para extrair as informa√ß√µes do texto do cliente
            break;
    }

    const titulo = escapeUnicode(document.getElementById('titulo_resumido').value);
    const urlIntroducao = referencias.gerarUrlValida("introducao", "principios");

    const jsonData = {
        "01-00-introducao": {
            "title": `1. ${titulo}`,
            "description": `Explora√ß√£o de como os princ√≠pios de ${principios}, desenvolvidos por ${desenvolvidoPor}, podem ser aplicados em ${aplicacao}.`,
            "url": urlIntroducao,
            "category": `1. ${principios} em ${aplicacao}`,
            "videoUrl": urlVideo
        }
    };

    document.getElementById('jsonOutput').textContent = JSON.stringify(jsonData, null, 2);

    const referenciasUrls = referencias.lista.length > 0 
        ? referencias.lista.map(ref => ref.url).join('\n- ')
        : '- https://exemplo.com (nenhuma refer√™ncia fornecida)';

    const prompt = `
Tarefa: Criar uma estrutura JSON para o M.A.E. que explique como os princ√≠pios [${principios}], desenvolvidos por [${desenvolvidoPor}], podem ser aplicados em [${aplicacao}].

${urlVideo ? `URL do V√≠deo: ${urlVideo}` : ''}

URLs de Refer√™ncia Fornecidas:
- ${referenciasUrls}

Requisitos:
 vc √© um acelerador de desenvlvimento de conte√∫do, que sabe ler links, textos,frases, principios, autores, aplicabilidade ( aplica√ß√µes)  e consegue identificar como estruturar contextos, textos, transcri√ß√µes, listas transformando-os em categorias, tpicos, desci√ß√£o  e URL  entregando um arquivo JSON com a seguinte instru√ß√£o  

- Formato JSON: Estruturar o conte√∫do em formato JSON.

 - Codifica√ß√£o Unicode: Utilizar codifica√ß√£o Unicode para caracteres especiais.
- Exemplos Pr√°ticos: Incluir exemplos pr√°ticos com formata√ß√£o de texto com quebra de linha e par√°grafos, que facilite a leitura e compreens√£o na descri√ß√£o.
- URLs Relevantes: Para cada objeto do JSON, gerar uma URL que DEVE seguir este padr√£o:
  * Se existirem URLs de refer√™ncia fornecidas: usar uma das URLs base listadas acima, escolhida aleatoriamente, e adicionar um path relacionado ao contexto do objeto
  * Se n√£o existirem URLs de refer√™ncia: usar "https://exemplo.com" como base
  Exemplo de URL gerada: Se a URL base for "https://site1.com", a URL final poderia ser "https://site1.com/principios/gestao" ou "https://site1.com/aplicacao/metodologia"
- Estrutura de Categorias: Criar EXATAMENTE 7 categorias relevantes para o contexto de consultoria, cada uma contendo EXATAMENTE 3 t√≠tulos com descri√ß√µes claras e objetivas. A primeira categoria deve usar o input 1 e 3 do formul√°rio.
- Detalhamento das Categorias: Cada categoria deve conter uma descri√ß√£o clara e objetiva.
- Os itens dentro de cada categoria devem ser aplic√°veis ao contexto de consultoria.
- Garantir √¢ncoras relacionadas a cada um dos 3 t√≥picos de cada uma das 7 categorias geradas, concatenando as diferentes fontes (Sites) para distribuir nas URLs que consideram as √¢ncoras por t√≥picos.
- Incluir sempre a Categoria APOIO como a oitava categoria, contendo os seguintes itens:
  1. √çndice Estrat√©gico Din√¢mico: Abra o √çndice Estrat√©gico Din√¢mico para suas anota√ß√µes
     URL: https://sobralfreenat.github.io/indice_estrategico/
     
   2: Suporte Adicional: Recursos e ferramentas complementares  invideo
       URL: https://ai.invideo.io/workspace/

  3. Contato FNW Assessoria: Entre em contato via WhatsApp
     URL: https://wa.me/5511911595028

Exemplo de Estrutura Esperada:
{
  "1-0-introducao-principios": {
    "title": "1. [utilizar input 1 do formul√°rio]",
    "description": "Explora√ß√£o de como os princ√≠pios desenvolvidos por [desenvolvidoPor] podem ser aplicados em [aplicacao].",
    "url": "[usar uma URL base das refer√™ncias]/introducao-principios",
    "category": "1. [utilizar input 1 e 3 do formul√°rio]",
    "videoUrl": "[URL do v√≠deo, se aplic√°vel]"
  },
  "1-1-fundamentos": {
    "title": "1.1. Fundamentos B√°sicos",
    "description": "Descri√ß√£o dos fundamentos b√°sicos...",
    "url": "[usar uma URL base das refer√™ncias]/fundamentos",
    "category": "1. [utilizar input 1 e 3 do formul√°rio]"
  },
  "1-2-conceitos": {
    "title": "1.2. Conceitos Principais",
    "description": "Descri√ß√£o dos conceitos principais...",
    "url": "[usar uma URL base das refer√™ncias]/conceitos",
    "category": "1. [utilizar input 1 e 3 do formul√°rio]"
  },
  "1-3-aplicacoes": {
    "title": "1.3. Aplica√ß√µes Pr√°ticas",
    "description": "Descri√ß√£o das aplica√ß√µes pr√°ticas...",
    "url": "[usar uma URL base das refer√™ncias]/aplicacoes",
    "category": "1. [utilizar input 1 e 3 do formul√°rio]"
  },
  // ... (incluir as categorias 2 a 7 acima, seguindo o mesmo padr√£o)

  // ... Incluir as categorias abaixo como complementares **exatamente** como est√£o
  "8-0-apoio": {
    "title": "8. Apoio e Recursos Adicionais",
    "description": "Ferramentas e recursos de suporte para aprimorar a aplica√ß√£o dos princ√≠pios em consultoria.",
    "url": "https://sobralfreenat.github.io/indice_estrategico/",
    "category": "8. Apoio e Recursos Adicionais"
  },
  "8-1-invideo-com-ia": {
    "title": "8.1. Video com IA",
    "description": "Abra o Invideo.ai para converter os textos dos cards em videos.",
    "url": "https://ai.invideo.io/workspace/",
    "category": "8. Apoio e Recursos Adicionais"
  },
  "8-2-contato-fnw": {
    "title": "8.2. Contato FNW Assessoria",
    "description": "Entre em contato via WhatsApp com a FNW Assessoria para suporte personalizado.",
    "url": "https://wa.me/5511911595028",
    "category": "8. Apoio e Recursos Adicionais"
  }
}

Importante:
1. Mantenha a estrutura JSON exatamente como mostrado no exemplo
2. Use as URLs de refer√™ncia fornecidas para gerar as URLs de cada objeto
3. Garanta que todas as URLs geradas sejam √∫nicas dentro do JSON
4. Mantenha a consist√™ncia na numera√ß√£o das categorias (1, 2, 3, etc.)
5. Garanta que os paths adicionados √†s URLs base fa√ßam sentido com o contexto do objeto
6. Certifique-se de criar EXATAMENTE 7 categorias, cada uma com EXATAMENTE 3 itens
7. Inclua a categoria APOIO como a s√©tima categoria, conforme especificado
8. Utilize √¢ncoras relacionadas a cada t√≥pico nas URLs geradas
9. Inclua a URL do v√≠deo em cada objeto do JSON, se aplic√°vel

10. Fa√ßa a varredura no link de referencia e no link indicado; inclua a URL do tempo do v√≠deo do youtube em cada objeto do JSON.   

11. Ap√≥s e **somente ap√≥s** o JSON Inteirmanete e corretamente estruturado, crie um Arquivo para Download com o nome iniciando com M.A.E. e em seguida inclua a abrevia√ß√£o coerente com o contexto  

`;

    document.getElementById('promptOutput').textContent = prompt;
    document.getElementById('promptEditor').value = prompt;
}

function copiarPrompt() {
    const promptContent = document.getElementById('promptOutput').textContent;
    navigator.clipboard.writeText(promptContent).then(() => {
        alert("Prompt copiado para a √°rea de transfer√™ncia!");
    });
}

function abrirIASelecionada() {
    const select = document.getElementById('iaEscolhida');
    let url = select.value;
    
    if (url === 'outro') {
        url = document.getElementById('linkPersonalizado').value;
    }
    
    if (!url) {
        alert('Por favor, selecione uma IA ou forne√ßa um link v√°lido!');
        return;
    }
    
    abrirOuFocarJanela(url, 'IA_Window', 800, 600, 200, 100);
}

function abrirOuFocarJanela(url, title, width, height, left, top) {
    const newWindow = window.open(url, title, `width=${width},height=${height},left=${left},top=${top}`);
    if (newWindow.focus) {
        newWindow.focus();
    }
    document.getElementById('gptText').focus();
}

function processarTextoGPT() {
    const gptText = document.getElementById('gptText').value;
    try {
        const processedJSON = JSON.parse(gptText);
        const blob = new Blob([JSON.stringify(processedJSON, null, 2)], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        const nomeArquivo = gerarNomeArquivoJSON();
        if (nomeArquivo) {
            a.download = nomeArquivo;
            a.click();
            URL.revokeObjectURL(url);
        }
    } catch (error) {
        alert("Erro ao processar o texto. Verifique se o formato est√° correto.");
    }
}

function gerarNomeArquivoJSON() {
    const titulo = document.getElementById('titulo_resumido').value.replace(/\s+/g, '_');
    const iaEscolhida = document.getElementById('iaEscolhida').value;
    const ia = iaEscolhida === 'outro' ? 'personalizada' : iaEscolhida.split('/').pop();
    return `M.A.E._${titulo}_${ia}.json`;
}

function salvarEstado() {
    const estado = {
        modoEntrada: document.getElementById('modoEntrada').value,
        urlVideo: document.getElementById('urlVideo').value,
        transcricaoYoutube: document.getElementById('transcricaoYoutube').value,
        principios: document.getElementById('principios').value,
        desenvolvidoPor: document.getElementById('desenvolvidoPor').value,
        aplicacao: document.getElementById('aplicacao').value,
        textoCliente: document.getElementById('textoCliente').value,
        titulo_resumido: document.getElementById('titulo_resumido').value,
        referencias: referencias.lista,
        iaEscolhida: document.getElementById('iaEscolhida').value,
        linkPersonalizado: document.getElementById('linkPersonalizado').value,
        promptEditor: document.getElementById('promptEditor').value
    };
    localStorage.setItem('mae_estado', JSON.stringify(estado));
    alert('Estado salvo com sucesso!');
}

function carregarEstado() {
    const estadoSalvo = localStorage.getItem('mae_estado');
    if (estadoSalvo) {
        const estado = JSON.parse(estadoSalvo);
        document.getElementById('modoEntrada').value = estado.modoEntrada || 'youtube';
        document.getElementById('urlVideo').value = estado.urlVideo || '';
        document.getElementById('transcricaoYoutube').value = estado.transcricaoYoutube || '';
        document.getElementById('principios').value = estado.principios || '';
        document.getElementById('desenvolvidoPor').value = estado.desenvolvidoPor || '';
        document.getElementById('aplicacao').value = estado.aplicacao || '';
        document.getElementById('textoCliente').value = estado.textoCliente || '';
        document.getElementById('titulo_resumido').value = estado.titulo_resumido || '';
        referencias.lista = estado.referencias || [];
        referencias.atualizarLista();
        document.getElementById('iaEscolhida').value = estado.iaEscolhida || '';
	        document.getElementById('linkPersonalizado').value = estado.linkPersonalizado || '';
        document.getElementById('promptEditor').value = estado.promptEditor || '';
        alternarModoEntrada();
        verificarSelecaoIA();
        alert('Estado carregado com sucesso!');
    } else {
        alert('Nenhum estado salvo encontrado.');
    }
}

function processarTranscricaoYoutube() {
    const urlVideo = document.getElementById('urlVideo').value.trim();
    const transcricao = document.getElementById('transcricaoYoutube').value.trim();
    
    if (!urlVideo) {
        alert('Por favor, insira a URL do v√≠deo do YouTube.');
        return;
    }
    if (!transcricao) {
        alert('Por favor, insira a transcri√ß√£o do v√≠deo do YouTube.');
        return;
    }

    // Dividir a transcri√ß√£o em par√°grafos
    const paragrafos = transcricao.split('\n\n');

    // Extrair informa√ß√µes relevantes
    let principios = [];
    let desenvolvidoPor = [];
    let aplicacao = [];
    let titulo = '';

    paragrafos.forEach(paragrafo => {
        const paragrafoLower = paragrafo.toLowerCase();
        if (paragrafoLower.includes('princ√≠pio') || paragrafoLower.includes('principio')) {
            principios.push(paragrafo);
        } else if (paragrafoLower.includes('desenvolvido por') || paragrafoLower.includes('autor')) {
            desenvolvidoPor.push(paragrafo);
        } else if (paragrafoLower.includes('aplica√ß√£o') || paragrafoLower.includes('aplicacao')) {
            aplicacao.push(paragrafo);
        } else if (paragrafoLower.includes('t√≠tulo') || paragrafoLower.includes('titulo')) {
            titulo = paragrafo;
        }
    });

    // Preparar informa√ß√µes extra√≠das
    const infoExtraida = {
        urlVideo: urlVideo,
        principios: principios.join('\n\n'),
        desenvolvidoPor: desenvolvidoPor.join('\n\n'),
        aplicacao: aplicacao.join('\n\n'),
        titulo: titulo.replace(/^(t√≠tulo|titulo):\s*/i, '').trim()
    };

    // Preencher os campos do formul√°rio
    document.getElementById('principios').value = infoExtraida.principios;
    document.getElementById('desenvolvidoPor').value = infoExtraida.desenvolvidoPor;
    document.getElementById('aplicacao').value = infoExtraida.aplicacao;
    document.getElementById('titulo_resumido').value = infoExtraida.titulo.split(' ').slice(0, 5).join(' ');

    // Log para depura√ß√£o
    console.log('Informa√ß√µes extra√≠das:', infoExtraida);

    // Mostrar resumo das informa√ß√µes extra√≠das
    let resumo = 'Informa√ß√µes extra√≠das e campos preenchidos:\n\n';
    resumo += `URL do V√≠deo: ${infoExtraida.urlVideo}\n\n`;
    if (infoExtraida.principios) resumo += `Princ√≠pios: ${infoExtraida.principios.substring(0, 100)}...\n\n`;
    if (infoExtraida.desenvolvidoPor) resumo += `Desenvolvido por: ${infoExtraida.desenvolvidoPor.substring(0, 100)}...\n\n`;
    if (infoExtraida.aplicacao) resumo += `Aplica√ß√£o: ${infoExtraida.aplicacao.substring(0, 100)}...\n\n`;
    if (infoExtraida.titulo) resumo += `T√≠tulo: ${infoExtraida.titulo}\n\n`;
    resumo += 'Os campos foram preenchidos. Por favor, verifique e ajuste se necess√°rio.';

    alert(resumo);

    // Gerar JSON e Prompt
    gerarJSONePrompt().catch(error => {
        console.error(error);
        alert('Erro ao gerar JSON e prompt: ' + error.message);
    });
}

function processarTextoCliente() {
    const textoCliente = document.getElementById('textoCliente').value.trim();
    if (!textoCliente) {
        alert('Por favor, insira o texto do cliente.');
        return;
    }

    // Aqui voc√™ deve implementar a l√≥gica para processar o texto do cliente
    // Por exemplo, voc√™ pode tentar extrair informa√ß√µes no formato M.A.E.
    // Esta √© uma implementa√ß√£o b√°sica e pode precisar ser ajustada conforme suas necessidades

    const linhas = textoCliente.split('\n');
    let categoria = '', titulo = '', descricao = '', url = '';

    linhas.forEach(linha => {
        if (linha.toLowerCase().startsWith('categoria:')) {
            categoria = linha.substring(10).trim();
        } else if (linha.toLowerCase().startsWith('t√≠tulo:') || linha.toLowerCase().startsWith('titulo:')) {
            titulo = linha.substring(7).trim();
        } else if (linha.toLowerCase().startsWith('descri√ß√£o:') || linha.toLowerCase().startsWith('descricao:')) {
            descricao = linha.substring(10).trim();
        } else if (linha.toLowerCase().startsWith('url:')) {
            url = linha.substring(4).trim();
        }
    });

    // Preencher os campos do formul√°rio com as informa√ß√µes extra√≠das
    document.getElementById('principios').value = categoria;
    document.getElementById('desenvolvidoPor').value = 'Extra√≠do do texto do cliente';
    document.getElementById('aplicacao').value = descricao;
    document.getElementById('titulo_resumido').value = titulo.split(' ').slice(0, 5).join(' ');

    // Mostrar resumo das informa√ß√µes extra√≠das
    let resumo = 'Informa√ß√µes extra√≠das do texto do cliente:\n\n';
    resumo += `Categoria: ${categoria}\n`;
    resumo += `T√≠tulo: ${titulo}\n`;
    resumo += `Descri√ß√£o: ${descricao}\n`;
    resumo += `URL: ${url}\n\n`;
    resumo += 'Os campos foram preenchidos. Por favor, verifique e ajuste se necess√°rio.';

    alert(resumo);

    // Gerar JSON e Prompt
    gerarJSONePrompt().catch(error => {
        console.error(error);
        alert('Erro ao gerar JSON e prompt: ' + error.message);
    });
}

// Inicializa√ß√£o
document.addEventListener('DOMContentLoaded', function() {
    referencias.carregarReferencias();
    
    document.getElementById('togglePromptEditor').addEventListener('click', function() {
        const editor = document.getElementById('promptEditor');
        const button = document.getElementById('togglePromptEditor');
        if (editor.style.display === 'none') {
            editor.style.display = 'block';
            button.textContent = 'Colapsar Editor';
        } else {
            editor.style.display = 'none';
            button.textContent = 'Expandir Editor';
        }
    });

    document.getElementById('editButton').addEventListener('click', function() {
        const promptEditor = document.getElementById('promptEditor');
        document.getElementById('promptOutput').textContent = promptEditor.value;
        alert('Prompt atualizado!');
    });

    document.getElementById('saveStateButton').addEventListener('click', salvarEstado);
    document.getElementById('loadStateButton').addEventListener('click', carregarEstado);

    alternarModoEntrada(); // Inicializar o modo de entrada correto
});
</script>
</body>
</html>
        
